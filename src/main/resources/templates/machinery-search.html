<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Buscar Maquinaria - AgroRent</title>
  <link rel="stylesheet" th:href="@{/css/main.css}" />
</head>
<body>
<header>
  <h1>AgroRent</h1>
  <nav>
    <a th:href="@{/}">Inicio</a>
    <a th:href="@{/machinery}">Buscar Maquinaria</a>
    <a th:href="@{/login}">Ingresar</a>
    <a th:href="@{/register}">Registrarse</a>
  </nav>
</header>

<main>
  <section class="search-section">
    <h2>Buscar Maquinaria Agrícola</h2>
    <form th:action="@{/machinery/search}" method="get" class="search-form">
      <div class="form-row">
        <div class="form-group">
          <label for="type">Tipo de Maquinaria:</label>
          <select id="type" name="type">
            <option value="">Todos los tipos</option>
            <option value="Tractor">Tractor</option>
            <option value="Cosechadora">Cosechadora</option>
            <option value="Sembradora">Sembradora</option>
            <option value="Pulverizadora">Pulverizadora</option>
            <option value="Arado">Arado</option>
            <option value="Rastrillo">Rastrillo</option>
          </select>
        </div>
        <div class="form-group">
          <label for="location">Ubicación:</label>
          <input type="text" id="location" name="location" placeholder="Ej: Santiago, Rancagua, Talca">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="minPrice">Precio mínimo ($):</label>
          <input type="number" id="minPrice" name="minPrice" placeholder="0" min="0">
        </div>
        <div class="form-group">
          <label for="maxPrice">Precio máximo ($):</label>
          <input type="number" id="maxPrice" name="maxPrice" placeholder="200000" min="0">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="from">Disponible desde:</label>
          <input type="date" id="from" name="from">
        </div>
        <div class="form-group">
          <label for="to">Disponible hasta:</label>
          <input type="date" id="to" name="to">
        </div>
      </div>
      
      <button type="submit" class="btn-primary">Buscar Maquinaria</button>
    </form>
  </section>

  <section class="results-section">
    <h3>Resultados de Búsqueda</h3>
    <div th:if="${machineryList != null and !machineryList.empty}" class="machinery-grid">
      <div th:each="m : ${machineryList}" class="machinery-card">
        <h4 th:text="${m.type + ' ' + m.brand + ' ' + m.model}"></h4>
        <div class="machinery-info">
          <p><strong>Año:</strong> <span th:text="${m.year}"></span></p>
          <p><strong>Ubicación:</strong> <span th:text="${m.location}"></span></p>
          <p><strong>Capacidad:</strong> <span th:text="${m.capacity + ' HP'}"></span></p>
          <p><strong>Precio:</strong> <span class="price" th:text="${'$' + #numbers.formatDecimal(m.pricePerDay, 0, 'POINT', 0, 'NONE') + '/día'}"></span></p>
          <p><strong>Disponible:</strong> <span th:text="${#temporals.format(m.availableFrom, 'dd/MM/yyyy') + ' - ' + #temporals.format(m.availableTo, 'dd/MM/yyyy')}"></span></p>
        </div>
        <a th:href="@{|/machinery/${m.id}|}" class="btn-secondary">Ver Detalles</a>
      </div>
    </div>
    <div th:if="${machineryList == null or machineryList.empty}" class="no-results">
      <p>No se encontraron resultados para tu búsqueda. Intenta con otros criterios.</p>
    </div>
  </section>
</main>

<footer>© 2025 AgroRent</footer>
</body>
</html>
